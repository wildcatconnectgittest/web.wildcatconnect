<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="apple-touch-icon" sizes="57x57" href="./../favicon/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="./../favicon/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./../favicon/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="./../favicon/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./../favicon/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="./..//favicon/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="./../favicon/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="./../favicon/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./../favicon/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="./../favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="./../favicon/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="./../favicon/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="./../favicon/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="./../favicon/manifest.json">
    <link rel="mask-icon" href="./../favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <title>WildcatConnect</title>

    <!-- Bootstrap core CSS -->
    <link href="./../css/bootstrap.min.css" rel="stylesheet">

    <link href="./../css/signin.css" rel="stylesheet">

    <link href="./../css/sticky-footer-navbar.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!--link href="./css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <!--link href="navbar-static-top.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!--script src="../../assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a><img src="./../logoTransparent.gif" alt="Logo" width="54" style="display: inline-block; vertical-align: middle;"/></a>
          <a class="navbar-brand">WildcatConnect</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul id="spinnerDiv" class="nav navbar-nav">
            <!--li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li-->
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Account <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li>
                  <a href="" id="changePassword">Change Password</a>
                </li>
                <li>
                  <a href="mailto:support@wildcatconnect.org">Report an issue</a></li><li role="separator" class="divider"></li><li><a href="" id="logOut">Log Out</a>
                </li>
              </ul>
            </li>
          </ul>
          <!--ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Account<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Change Password</a></li>
                <li><a href="#">Report an issue</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#">Log Out</a></li>
              </ul>
            </li>
          </ul-->
        </div--><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="main-container" style="padding-left:20px; padding-right:20px;">

      <button class="cancel btn btn-lg btn-primary" type="cancel">Cancel</button>
      <h2>Group Update</h2>
      <form class="form-add-groupUpdate" role="form">
        <label for="ECselect" id="groupLabel">Select Group(s) ... LOADING</label><br>
        <input type="text" id="search" placeholder=" SEARCH"><br><br>
        <div id="checkboxes">
          
        </div>
        <br>
        <div class="form-group">
          <label for="message">Message (140 characters max)</label>
          <textarea name="message" class="form-control" rows="4" maxlength="140"></textarea>
        </div>
        <button class="btn btn-lg btn-primary btn-block" type="submit">Submit</button>
      </form>

    </div> <!-- /container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./../js/jquery.min.js"></script>
    <script src="./../js/parse-1.2.19.min.js"></script>
    <!--script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script-->
    <script src="./../js/bootstrap.min.js"></script>
    <script src="./../js/uglyScript.js"></script>
    <script src="./../js/date.js"></script>
    <script src="./../js/dialog.js"></script>

    <script type="text/javascript">

      window.onerror = function(error, url, line) {
          $(document).ready(errorFunction(error, url, line));
      };

      Parse.$ = jQuery;
      Parse.initialize("cLBOvwh6ZTQYex37DSwxL1Cvg34MMiRWYAB4vqs0", "tTcV5Ns1GFdDda44FCcG5XHBDMbLA1sxRUzSnDgW");
      if (Parse.User.current()) {
        //
      } else {
        window.location.replace("./login");
      };
    </script>

    <script>
      $("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');

      var structuresArray = new Array();

      Parse.User.current().fetch({
        success: function(user) {
          var box = document.getElementById('checkboxes');
          var query = new Parse.Query("ExtracurricularStructure");
          query.ascending("titleString");
          if (Parse.User.current().get("userType") === "Administration" || Parse.User.current().get("userType") === "Developer") {
            //
          } else {
            query.containedIn("extracurricularID", Parse.User.current().get("ownedEC"));
          };
          query.find({
            success: function(structures) {
              for (var i = 0; i < structures.length; i++) {
                var node = document.createElement('div');        
                node.innerHTML = '<input type="checkbox" onchange="arrayEdit(' + structures[i].get("extracurricularID")+');" id="check' + i + '" value="' + structures[i].get("extracurricularID") + '" name="check' + i + '">' + ' ' + structures[i].get("titleString") + '';
                box.appendChild(node);
              };
              $("#groupLabel").html("Select Group(s)");
              if (structures.length == 0) {
                $("#spinnerDiv").html("");
                BootstrapDialog.show({
                  type: BootstrapDialog.TYPE_DEFAULT,
                  closable: false,
                  title: "Whoops!",
                  message: "You are not the owner of any Extracurricular groups. However, you can REGISTER a new group on the home page, where you will be able to send push notifications to users who subscribe.",
                  buttons: [
                   {
                    label: "Got it.",
                    action: function(dialogItself) {
                      window.location.replace("./index");
                    }
                    
                  }]
                });
              };
              $("#spinnerDiv").html("");
            },
            error: function(error) {
              BootstrapDialog.show({
                  type: BootstrapDialog.TYPE_DEFAULT,
                  title: "Error",
                  message: "Error loading data from server."
              });
              $("#spinnerDiv").html("");
            }
          });
        },
        error: function(error) {
          BootstrapDialog.show({
              type: BootstrapDialog.TYPE_DEFAULT,
              title: "Error",
              message: "Error loading data from server."
          });
          $("#spinnerDiv").html("");
        }
      });

      function arrayEdit(j) {
        if ($.inArray(j, structuresArray) > -1) {
          if (structuresArray.length === 1) {
            structuresArray.pop();
          } else {
            structuresArray.splice(structuresArray.indexOf(j), 1);
          };
        } else {
          structuresArray.push(j);
        };
        $(document).ready(startThree(structuresArray));
      }

      $('#search').keyup(function() {

        var $rows = $('#checkboxes div');

        for (var i = 0; i < $rows.length; i++) {
          if ($rows[i].innerHTML.toLowerCase().indexOf(($(this).val()).toLowerCase()) > -1) {
            $($rows[i]).show();
          } else {
            $($rows[i]).hide();
          };
        }
      });
    </script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!--script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>