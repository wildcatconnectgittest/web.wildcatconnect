function errorFunction(e,t,n){var r=Parse.Object.extend("ErrorStructure"),a=new r;a.set("deviceToken","Web Client"),a.set("nameString","JavaScript Error"),a.set("infoString","Message = "+e+" - File = "+t+" - Line = "+n),a.set("version","Latest web release."),a.set("username",Parse.User.current().get("username")),a.save()}function start(e){return function(){window.imageFile=new Parse.File("image.png",e)}}function startTwo(e){return function(){window.daysArray=e}}function startThree(e){return function(){window.groupsArray=e}}function customView(){return function(){var e=localStorage.getItem("customDate").split("-"),t=new Date(e[2],e[0]-1,e[1]),n=t.toString("dddd, MMMM d, yyyy");$("#topLabel").html("Custom Schedule - "+n),$("#customArea").val(localStorage.getItem("customString")),$("#scheduleDescription").val(localStorage.getItem("customDescription"))}}function loadNewUserTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("UserRegisterStructure");e.ascending("lastName"),e.find({success:function(e){$("#newLabel").html("New User Requests ("+e.length+")");var t=document.getElementById("newUsers"),n=document.createElement("TABLE"),r=document.createElement("TBODY");$("#newUsers").html(""),n.appendChild(r),n.className="table table-striped";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="Action";var i=document.createElement("TR");r.appendChild(i);for(var l=0;l<a.length;l++){var o=document.createElement("TH");o.width="25%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.userArray=new Array;for(var l=0;l<e.length;l++){window.userArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(d);var s=document.createElement("TD");s.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(s);var c=document.createElement("TD");c.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(c);var u=document.createElement("TD"),m=document.createElement("INPUT");m.type="button",m.className="approveUser btn btn-lg btn-primary",m.value="Approve",m.name=l,m.style.marginRight="10px",m.onclick=function(){var e=l;return function(t){var n=window.confirm("Are you sure you want to approve this user?");if(1==n){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=window.userArray[e],a=r.get("password"),i=r.get("key");Parse.Cloud.run("decryptPassword",{password:a},{success:function(e){Parse.Cloud.run("registerUser",{username:r.get("username"),password:e,email:r.get("email"),firstName:r.get("firstName"),lastName:r.get("lastName"),key:i},{success:function(){$("#spinnerDiv").html(""),alert("User approved!"),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e.message),$("#spinnerDiv").html("")}})}}}(),u.appendChild(m);var p=document.createElement("INPUT");p.type="button",p.className="btn btn-lg btn-primary",p.value="Deny",m.name=l,p.style.marginRight="10px",p.style.backgroundColor="red",p.style.borderColor="red",p.onclick=function(){var e=l;return function(t){var n=window.confirm("Are you sure you want to deny this user?");if(1==n){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=window.userArray[e],a=new Parse.Query("UserRegisterStructure");a.equalTo("username",r.get("username")),a.first({success:function(e){e.destroy({success:function(e){alert("User successfully denied request."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}(),u.appendChild(p),i.appendChild(u),r.appendChild(i),t.appendChild(n)}},error:function(e){alert(e)}})}}function loadExistingUserTable(){return function(){var e=new Parse.Query("User");e.ascending("lastName"),e.find({success:function(e){$("#existingLabel").html("Existing Users ("+e.length+")");var t=document.getElementById("existingUsers"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped",n.id="userTable";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="User Type",a[4]="Change Type",a[5]="Action";var i=document.createElement("TR");r.appendChild(i),$("#existingUsers").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");o.width="17%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(d);var s=document.createElement("TD");s.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(s);var c=document.createElement("TD");c.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(c);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("userType"))),i.appendChild(u);var m=document.createElement("TD"),p=document.createElement("SELECT");p.name="typeSelect";var g=document.createElement("option");g.value=-1,g.text="NONE SELECTED",p.appendChild(g);for(var v=["Developer","Administration","Faculty","Lunch Manager"],h=0;h<v.length;h++){var g=document.createElement("option");g.value=h,g.text=v[h],p.appendChild(g)}p.onchange=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to update this user?");if(1==r){var a=v[this.selectedIndex-1];$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("updateType",{username:e[t].get("username"),type:a},{success:function(){alert("User successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}(),m.appendChild(p),i.appendChild(m);var f=document.createElement("TD"),y=document.createElement("INPUT");y.type="button",y.className="btn btn-lg btn-primary",y.value="Delete",y.name=l,y.style.marginRight="10px",y.style.backgroundColor="red",y.style.borderColor="red",y.onclick=function(){var e=l;return function(t){var n=window.existingUserArray[e];if(n.get("username")!=Parse.User.current().get("username").toString()){var r=confirm("Are you sure you want to delete "+n.get("firstName")+" "+n.get("lastName")+" as a user?");event.preventDefault(),1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("deleteUser",{username:n.get("username")},{success:function(){alert("User successfully deleted."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}else alert("You cannot delete yourself as a user!"),$("#spinnerDiv").html("")}}(),f.appendChild(y),i.appendChild(f),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){alert(e)}})}}function loadLunchTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("SchoolDayStructure");e.equalTo("isActive",1),e.ascending("schoolDayID");new Array;e.find({success:function(e){$("#titleLabel").html("Available School Days ("+e.length+")");var t=document.getElementById("schedules"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped";var a=new Array;a[0]="Date",a[1]="Breakfast",a[2]="Lunch";var i=document.createElement("TR");r.appendChild(i),$("#schedules").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");0==l?o.width="20%":o.width="40%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD"),s=e[l].get("schoolDate").split("-"),c=new Date(s[2],s[0]-1,s[1]),u=c.toString("dddd, MMMM d, yyyy");d.appendChild(document.createTextNode(u)),i.appendChild(d);var m=document.createElement("TD"),p=document.createElement("TEXTAREA");p.value=e[l].get("breakfastString"),p["class"]="form-control",p.style.display="block",p.style.width="100%",p.style.overflowY="scroll",p.style.resize="none",p.id="b_"+l,m.appendChild(p),i.appendChild(m);var g=document.createElement("TD"),v=document.createElement("TEXTAREA");v.value=e[l].get("lunchString"),v["class"]="form-control",v.style.display="block",v.style.width="100%",v.style.overflowY="scroll",v.style.resize="none",v.id="l_"+l,g.appendChild(v),i.appendChild(g),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadNewsTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("NewsArticleStructure");e.equalTo("isApproved",0),e.ascending("createdAt");new Array;e.find({success:function(e){$("#titleLabel").html("Pending Wildcat News Requests ("+e.length+")");var t=document.getElementById("newsRequests"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped";var a=new Array;a[0]="Date Submitted",a[1]="Author",a[2]="Summary",a[3]="Content",a[4]="Action";var i=document.createElement("TR");r.appendChild(i),$("#newsRequests").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");3!=l?o.width="10%":o.width="60%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD"),s=e[l].createdAt,c=s.toString("dddd, MMMM d, yyyy @ h:mm tt");d.appendChild(document.createTextNode(c)),i.appendChild(d);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("authorString"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("summaryString"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("contentURLString"))),i.appendChild(u);var m=document.createElement("TD"),p=document.createElement("INPUT");p.type="button",p.className="approveUser btn btn-lg btn-primary",p.value="Approve",p.name=l,p.style.marginBottom="10px",p.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to approve this Wildcat News Story? It will be live to all app users.");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].set("isApproved",1),e[t].save({success:function(){$("#spinnerDiv").html(""),alert("Story successfully approved."),$(document).ready(loadNewsTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),m.appendChild(p);var g=document.createElement("INPUT");g.type="button",g.className="btn btn-lg btn-primary",g.value="Deny",p.name=l,g.style.marginRight="10px",g.style.backgroundColor="red",g.style.borderColor="red",g.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to deny this event?");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].destroy({success:function(){$("#spinnerDiv").html(""),alert("Story successfully denied."),$(document).ready(loadNewsTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),m.appendChild(g),i.appendChild(m),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadEventTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("EventStructure");e.equalTo("isApproved",0),e.ascending("createdAt");new Array;e.find({success:function(e){$("#titleLabel").html("Pending Event Requests ("+e.length+")");var t=document.getElementById("eventRequests"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped";var a=new Array;a[0]="Title",a[1]="Date",a[2]="Location",a[3]="Message",a[4]="User",a[5]="Action";var i=document.createElement("TR");r.appendChild(i),$("#eventRequests").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");3!=l?o.width="12%":o.width="40%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("titleString"))),i.appendChild(d);var s=document.createElement("TD"),c=e[l].get("eventDate"),u=c.toString("dddd, MMMM d, yyyy @ h:mm tt");s.appendChild(document.createTextNode(u)),i.appendChild(s);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("locationString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("messageString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("userString"))),i.appendChild(d);var m=document.createElement("TD"),p=document.createElement("INPUT");p.type="button",p.className="approveUser btn btn-lg btn-primary",p.value="Approve",p.name=l,p.style.marginBottom="10px",p.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to approve this event? It will be live to all app users.");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].set("isApproved",1),e[t].save({success:function(){$("#spinnerDiv").html(""),alert("Event successfully approved."),$(document).ready(loadEventTable()),$(document).ready(loadExistingEventTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),m.appendChild(p);var g=document.createElement("INPUT");g.type="button",g.className="btn btn-lg btn-primary",g.value="Deny",p.name=l,g.style.marginRight="10px",g.style.backgroundColor="red",g.style.borderColor="red",g.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to deny this event?");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].destroy({success:function(){$("#spinnerDiv").html(""),alert("Event successfully denied."),$(document).ready(loadEventTable()),$(document).ready(loadExistingEventTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),m.appendChild(g),i.appendChild(m),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadExistingEventTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("EventStructure");e.equalTo("isApproved",1),e.ascending("eventDate");new Array;e.find({success:function(e){$("#existingLabel").html("Current Active Events ("+e.length+")");var t=document.getElementById("currentEvents"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped",n.id="eventTable";var a=new Array;a[0]="Title",a[1]="Date",a[2]="Location",a[3]="Message",a[4]="User",a[5]="Action";var i=document.createElement("TR");r.appendChild(i),$("#currentEvents").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");3!=l?o.width="12%":o.width="40%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("titleString"))),i.appendChild(d);var s=document.createElement("TD"),c=e[l].get("eventDate"),u=c.toString("dddd, MMMM d, yyyy @ h:mm tt");s.appendChild(document.createTextNode(u)),i.appendChild(s);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("locationString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("messageString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("userString"))),i.appendChild(d);var m=document.createElement("TD"),p=document.createElement("INPUT");p.type="button",p.className="btn btn-lg btn-primary",p.value="Delete",p.style.marginRight="10px",p.style.backgroundColor="red",p.style.borderColor="red",p.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to delete this event?");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].destroy({success:function(){$("#spinnerDiv").html(""),alert("Event successfully deleted."),$(document).ready(loadEventTable()),$(document).ready(loadExistingEventTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),m.appendChild(p),i.appendChild(m),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadGroupTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("ExtracurricularStructure");e.ascending("titleString");new Array;e.find({success:function(e){$("#titleLabel").html("Currently Registered Groups ("+e.length+")");var t=document.getElementById("groups"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped",n.id="groupTable";var a=new Array;a[0]="Title",a[1]="Message",a[2]="Action";var i=document.createElement("TR");r.appendChild(i),$("#groups").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");o.width="33%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("titleString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("descriptionString"))),i.appendChild(d);var s=document.createElement("TD"),c=document.createElement("INPUT");c.type="button",c.className="btn btn-lg btn-primary",c.value="Delete",c.style.marginRight="10px",c.style.backgroundColor="red",c.style.borderColor="red",c.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to delete this group?");1==r&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),e[t].destroy({success:function(){$("#spinnerDiv").html(""),alert("Group successfully deleted."),$(document).ready(loadGroupTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),s.appendChild(c),i.appendChild(s),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadErrorTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("ErrorStructure");e.descending("createdAt"),e.find({success:function(e){$("#titleLabel").html("Recent iOS/Web App Errors and Crashes ("+e.length+")");var t=document.getElementById("errors"),n=document.createElement("TABLE"),r=document.createElement("TBODY");n.appendChild(r),n.className="table table-striped";var a=new Array;a[0]="Date",a[1]="Name",a[2]="Message",a[3]="Device Token",a[4]="Username",a[5]="Version",a[6]="Action";var i=document.createElement("TR");r.appendChild(i),$("#errors").html("");for(var l=0;l<a.length;l++){var o=document.createElement("TH");o.width="14%",o.appendChild(document.createTextNode(a[l])),i.appendChild(o)}for(var l=0;l<e.length;l++){var i=document.createElement("TR"),d=document.createElement("TD"),s=e[l].createdAt,c=s.toString("dddd, MMMM d, yyyy @ h:mm tt");d.appendChild(document.createTextNode(c)),i.appendChild(d);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("nameString"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("infoString"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("deviceToken"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("username"))),i.appendChild(u);var u=document.createElement("TD");u.appendChild(document.createTextNode(e[l].get("version"))),i.appendChild(u);var u=document.createElement("TD"),m=document.createElement("INPUT");m.type="button",m.className="btn btn-lg btn-primary",m.value="Delete",m.name=l,m.style.marginBottom="10px",m.style.backgroundColor="red",m.style.borderColor="red",m.onclick=function(){var t=l;return function(n){var r=window.confirm("Are you sure you want to delete this error?");1==r&&e[t].destroy({success:function(){alert("Error successfully deleted."),$(document).ready(loadErrorTable())},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}(),u.appendChild(m),i.appendChild(u),r.appendChild(i),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadLinksTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("UsefulLinkArray");e.ascending("index"),e.find({success:function(e){var t=document.getElementById("links");$("#links").html("");for(var n=0;n<e.length;n++){var r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Delete Category",r.name=n,r.id="deleteCategory_"+n,r.style["float"]="right",r.style.backgroundColor="red",r.style.borderColor="red",r.onclick=function(){return function(e){var t=window.confirm("Are you sure you want to delete this category?");1==t&&deleteCategoryFunction($(this))}}(),t.appendChild(r);var a=document.createElement("H4");a.innerHTML="Category Name",a.style["float"]="left",a.style.marginRight="10px",a.id="label_"+n,t.appendChild(a);var i=document.createElement("TEXTAREA");i.value=e[n].get("headerTitle"),i["class"]="form-control",i.style.display="block",i.id="header_"+n,i.width="33%",i.display="block",i.style.marginBottom="10px",t.appendChild(i);var l=document.createElement("TABLE");l.id="bigTable_"+n;var o=document.createElement("TBODY");o.id="table_"+n,l.appendChild(o),l.className="table table-striped";var d=new Array;d[0]="Link Title",d[1]="Hyperlink",d[2]="Action";var s=document.createElement("TR");o.appendChild(s);for(var c=0;c<d.length;c++){var u=document.createElement("TH");2>c?u.width="40%":u.width="20%",u.appendChild(document.createTextNode(d[c])),s.appendChild(u)}for(var m=e[n].get("linksArray"),p=0;p<m.length;p++){var s=document.createElement("TR");s.id="row_"+n+"_"+p;var g=m[p],v=document.createElement("TD"),h=document.createElement("TEXTAREA");h.value=g.titleString,h["class"]="form-control",h.style.display="block",h.style.width="100%",h.style.overflowY="scroll",h.style.resize="none",h.id="title_"+n+"_"+p,v.appendChild(h),s.appendChild(v);var v=document.createElement("TD"),f=document.createElement("TEXTAREA");f.value=g.URLString,f["class"]="form-control",f.style.display="block",f.style.width="100%",f.style.overflowY="scroll",f.style.resize="none",f.id="link_"+n+"_"+p,v.appendChild(f),s.appendChild(v);var v=document.createElement("TD");v.id="box_"+n+"_"+p;var r=document.createElement("INPUT");if(r.type="button",r.className="btn btn-lg btn-primary",r.value="Delete",r.name=n,r.id="delete_"+n+"_"+p,r.style.marginRight="10px",r.style.backgroundColor="red",r.style.borderColor="red",r.onclick=function(){return function(e){var t=window.confirm("Are you sure you want to delete this link?");1==t&&removeRowFunction($(this))}}(),v.appendChild(r),p==m.length-1){var r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Add Link",r.id="add_"+n,r.onclick=function(){return function(e){addRowFunction($(this))}}(),v.appendChild(r),s.appendChild(v),o.appendChild(s)}s.appendChild(v),o.appendChild(s),t.appendChild(l)}}var r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Add a New Category",r.name=n,r.style.marginBottom="10px",r.id="addCategory",r.onclick=function(){return function(e){addCategoryFunction()}}(),t.appendChild(r),$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function getDesiredIndex(e,t){if(0==t){var n,r=e.indexOf("_"),a=e.substring(r+1),i=a.indexOf("_");n=-1==i?a:a.substring(0,i);var l=parseInt(n);return l}if(1==t){var r=e.indexOf("_"),a=e.substring(r+1),i=a.indexOf("_"),n=a.substring(i+1),l=parseInt(n);return l}return-1}function deleteCategoryFunction(e){for(var t=e.attr("id"),n=getDesiredIndex(t,0),r=document.getElementById("bigTable_"+n),a=document.getElementById("links"),i=a.getElementsByTagName("textarea"),l=0;l<i.length;l++){var o=i[l].id;if(o)if(0==o.indexOf("title")){var d=getDesiredIndex(o,0),s=getDesiredIndex(o,1);d>n&&(i[l].id="title_"+(d-1).toString()+"_"+s.toString())}else if(0==o.indexOf("link")){var d=getDesiredIndex(o,0),s=getDesiredIndex(o,1);d>n&&(i[l].id="link_"+(d-1).toString()+"_"+s.toString())}else if(0==o.indexOf("header")){var d=getDesiredIndex(o,0);d>n&&(i[l].id="header_"+(d-1).toString())}}for(var c=a.getElementsByTagName("h4"),u=0;u<c.length;u++){var o=c[u].id;if(o&&0==o.indexOf("label")){var d=getDesiredIndex(o,0);d>n&&(c[u].id="label_"+(d-1).toString())}}for(var m=a.getElementsByTagName("table"),p=0;p<m.length;p++){var o=m[p].id;if(o&&0==o.indexOf("bigTable")){var d=getDesiredIndex(o,0);d>n&&(m[p].id="bigTable_"+(d-1).toString())}}for(var g=a.getElementsByTagName("tbody"),v=0;v<g.length;v++){var o=g[v].id;if(o&&0==o.indexOf("table")){var d=getDesiredIndex(o,0);d>n&&(g[v].id="table_"+(d-1).toString())}}for(var h=a.getElementsByTagName("tr"),f=0;f<h.length;f++){var o=h[f].id;if(o&&o.indexOf("row")>-1){var d=getDesiredIndex(o,0),s=getDesiredIndex(o,1);d>n&&(h[f].id="row_"+(d-1).toString()+"_"+s.toString())}}for(var y=a.getElementsByTagName("td"),w=0;w<y.length;w++){var o=y[w].id;if(o&&o.indexOf("box")>-1){var d=getDesiredIndex(o,0),s=getDesiredIndex(o,1);d>n&&(y[w].id="box_"+(d-1).toString()+"_"+s.toString())}}for(var D=a.getElementsByTagName("input"),b=0;b<D.length;b++){var o=D[b].id;if(o)if(0==o.indexOf("deleteCategory")){var d=getDesiredIndex(o,0);d>n&&(D[b].id="deleteCategory_"+(d-1).toString())}else if(0==o.indexOf("delete")){var d=getDesiredIndex(o,0),s=getDesiredIndex(o,1);d>n&&(D[b].id="delete_"+(d-1).toString()+"_"+s.toString())}else if(0==o.indexOf("add")){var d=getDesiredIndex(o,0);d>n&&(D[b].id="add_"+(d-1).toString())}}var T=document.getElementById("header_"+n),E=document.getElementById("label_"+n),C=document.getElementById("deleteCategory_"+n);r.parentNode.removeChild(r),T.parentNode.removeChild(T),E.parentNode.removeChild(E),C.parentNode.removeChild(C)}function addCategoryFunction(){var e=document.getElementById("addCategory");e.parentNode.removeChild(e);var t=document.getElementById("links"),n=t.getElementsByTagName("table").length,r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Delete Category",r.name=n,r.id="deleteCategory_"+n,r.style["float"]="right",r.style.backgroundColor="red",r.style.borderColor="red",r.onclick=function(){return function(e){var t=window.confirm("Are you sure you want to delete this category?");1==t&&deleteCategoryFunction($(this))}}(),t.appendChild(r);var a=document.createElement("H4");a.innerHTML="Category Name",a.style["float"]="left",a.style.marginRight="10px",a.id="label_"+n,t.appendChild(a);var i=document.createElement("TEXTAREA");i["class"]="form-control",i.style.display="block",i.id="header_"+n,i.width="33%",i.display="block",i.style.marginBottom="10px",t.appendChild(i);var l=document.createElement("TABLE");l.id="bigTable_"+n;var o=document.createElement("TBODY");o.id="table_"+n,l.appendChild(o),l.className="table table-striped";var d=new Array;d[0]="Link Title",d[1]="Hyperlink",d[2]="Action";var s=document.createElement("TR");o.appendChild(s);for(var c=0;c<d.length;c++){var u=document.createElement("TH");2>c?u.width="40%":u.width="20%",u.appendChild(document.createTextNode(d[c])),s.appendChild(u)}var s=document.createElement("TR");s.id="row_"+n+"_0";var m=document.createElement("TD"),p=document.createElement("TEXTAREA");p["class"]="form-control",p.style.display="block",p.style.width="100%",p.style.overflowY="scroll",p.style.resize="none",p.id="title_"+n+"_0",m.appendChild(p),s.appendChild(m);var m=document.createElement("TD"),g=document.createElement("TEXTAREA");g["class"]="form-control",g.style.display="block",g.style.width="100%",g.style.overflowY="scroll",g.style.resize="none",g.id="link_"+n+"_0",m.appendChild(g),s.appendChild(m);var m=document.createElement("TD");m.id="box_"+n+"_0";var r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Delete",r.name=n,r.id="delete_"+n+"_0",r.style.marginRight="10px",r.style.backgroundColor="red",r.style.borderColor="red",r.onclick=function(){return function(e){var t=window.confirm("Are you sure you want to delete this link?");1==t&&removeRowFunction($(this))}}(),m.appendChild(r);var r=document.createElement("INPUT");r.type="button",r.className="btn btn-lg btn-primary",r.value="Add Link",r.id="add_"+n,r.onclick=function(){return function(e){addRowFunction($(this))}}(),m.appendChild(r),s.appendChild(m),o.appendChild(s),t.appendChild(l),t.appendChild(e)}function removeRowFunction(e){var t=e.attr("id"),n=getDesiredIndex(t,0),r=getDesiredIndex(t,1),a=document.getElementById("table_"+n),i=a.getElementsByTagName("tr").length;if(0==r&&2==i){var l=window.confirm("Deleting this link will delete the entire category, since it is the last one left. Are you sure?");if(1==l){var e=document.createElement("input");e.id="deleteCategory_"+n;var o=$(e);deleteCategoryFunction(o)}}else{for(var d=a.getElementsByTagName("tr"),s=0;s<d.length;s++){var c=d[s].id;if(c){var u=getDesiredIndex(c,1);u>r&&(d[s].id="row_"+n+"_"+(u-1).toString())}}for(var m=a.getElementsByTagName("td"),p=0;p<m.length;p++){var c=m[p].id;if(c){var u=getDesiredIndex(c,1);u>r&&(m[p].id="box_"+n+"_"+(u-1).toString())}}for(var g=a.getElementsByTagName("textarea"),v=0;v<g.length;v++){
var c=g[v].id;if(c)if(0==c.indexOf("title")){var u=getDesiredIndex(c,1);u>r&&(g[v].id="title_"+n+"_"+(u-1).toString())}else if(0==c.indexOf("link")){var u=getDesiredIndex(c,1);u>r&&(g[v].id="link_"+n+"_"+(u-1).toString())}}for(var h=a.getElementsByTagName("input"),f=0;f<h.length;f++){var c=h[f].id;if(c&&c.indexOf("delete")>-1){var u=getDesiredIndex(c,1);u>r&&(h[f].id="delete_"+n+"_"+(u-1).toString())}}var y=document.getElementById("row_"+n+"_"+r);if(y.parentNode.removeChild(y),r==a.rows.length-1){var w=document.getElementById("box_"+n+"_"+(r-1)),e=document.createElement("INPUT");e.type="button",e.className="btn btn-lg btn-primary",e.value="Add Link",e.id="add_"+n,e.onclick=function(){return function(e){addRowFunction($(this))}}(),w.appendChild(e)}}}function addRowFunction(e){var t=e.attr("id"),n=getDesiredIndex(t,0),r=document.getElementById("table_"+n),e=document.getElementById("add_"+n);e.parentNode.removeChild(e);var a=r.getElementsByTagName("tr").length-1,i=document.createElement("TR");i.id="row_"+n+"_"+a;var l=document.createElement("TD"),o=document.createElement("TEXTAREA");o["class"]="form-control",o.style.display="block",o.style.width="100%",o.style.overflowY="scroll",o.style.resize="none",o.id="title_"+n+"_"+a,l.appendChild(o),i.appendChild(l);var l=document.createElement("TD"),d=document.createElement("TEXTAREA");d["class"]="form-control",d.style.display="block",d.style.width="100%",d.style.overflowY="scroll",d.style.resize="none",d.id="link_"+n+"_"+a,l.appendChild(d),i.appendChild(l);var l=document.createElement("TD");l.id="box_"+n+"_"+a;var e=document.createElement("INPUT");e.type="button",e.className="btn btn-lg btn-primary",e.value="Delete",e.id="delete_"+n+"_"+a,e.style.marginRight="10px",e.style.backgroundColor="red",e.style.borderColor="red",e.onclick=function(){return function(e){var t=window.confirm("Are you sure you want to delete this link?");1==t&&removeRowFunction($(this))}}(),l.appendChild(e);var e=document.createElement("INPUT");e.type="button",e.className="btn btn-lg btn-primary",e.value="Add Link",e.id="add_"+n,e.onclick=function(){return function(e){addRowFunction($(this))}}(),l.appendChild(e),i.appendChild(l),r.appendChild(i)}function loadScheduleTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=[],t=new Parse.Query("ScheduleType");t.ascending("typeID"),t.find({success:function(t){for(var n=0;n<t.length;n++){var r=t[n].get("typeID"),a=t[n].get("fullScheduleString");e[r]=a,reverseDictionary[n]=r}var i=new Parse.Query("SchoolDayStructure");i.equalTo("isActive",1),i.ascending("schoolDayID");var l=new Array;i.find({success:function(t){var n=new Parse.Query("SchoolDayStructure");n.equalTo("isActive",0),n.descending("schoolDayID"),n.first({success:function(n){l.push(n);for(var r=0;r<t.length;r++)l.push(t[r]);$("#titleLabel").html("Available School Days ("+l.length+")");var a=document.getElementById("schedules"),i=document.createElement("TABLE"),o=document.createElement("TBODY");i.appendChild(o),i.className="table table-striped";var d=new Array;d[0]="Date",d[1]="Schedule Type",d[2]="Change Type",d[3]="Custom Action";var s=document.createElement("TR");o.appendChild(s),$("#schedules").html("");for(var r=0;r<d.length;r++){var c=document.createElement("TH");c.width="25%",c.appendChild(document.createTextNode(d[r])),s.appendChild(c)}window.existingUserArray=new Array;for(var r=0;r<l.length;r++){window.existingUserArray.push(l[r]);var s=document.createElement("TR"),u=document.createElement("TD"),m=l[r].get("schoolDate").split("-"),p=new Date(m[2],m[0]-1,m[1]),g=p.toString("dddd, MMMM d, yyyy"),v=new Date;v=new Date(v.getFullYear(),v.getMonth(),v.getDate(),0,0,0,0),v>p||0==r&&0==l[r].get("isActive")?u.appendChild(document.createTextNode("INACTIVE SCHOOL DAY - ")):p.toDateString()===v.toDateString()&&(u.style.color="red"),u.appendChild(document.createTextNode(g)),s.appendChild(u);var h=l[r].get("scheduleType");if("*"===h){var f=document.createElement("TD");f.appendChild(document.createTextNode("CUSTOM SCHEDULE - "+l[r].get("customString"))),f.style.fontWeight="bold",s.appendChild(f)}else{var y=e[h],f=document.createElement("TD");f.appendChild(document.createTextNode(y)),s.appendChild(f)}if(v>!p&&(0!=r||1==l[r].get("isActive"))){var w=document.createElement("TD"),D=document.createElement("SELECT");D.name="typeSelect";var b=document.createElement("option");b.value=-1,b.text="NONE SELECTED",D.appendChild(b);for(var T=0;T<Object.keys(e).length;T++){var b=document.createElement("option");b.value=T,b.text=e[Object.keys(e)[T]],D.appendChild(b)}D.onchange=function(){var e=r;return function(t){var n=window.confirm("Are you sure you want to edit this day's schedule?");if(1==n){var r=reverseDictionary[this.selectedIndex-1];l[e].set("scheduleType",r),l[e].set("customSchedule","None."),l[e].set("customString",""),l[e].save(null,{success:function(e){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}}(),w.appendChild(D),s.appendChild(w)}else{var w=document.createElement("TD");w.appendChild(document.createTextNode("No actions available.")),s.appendChild(w)}var E=document.createElement("TD");if(2>r){var C=document.createElement("INPUT");C.type="button",C.className="btn btn-lg btn-primary",C.value="Snow Day",C.name=r,C.style.marginBottom="10px",C.onclick=function(){var e=r;return function(t){if(e!=l.length-1){var n=window.confirm("Are you sure you want to make this day a snow day? This will affect all schedules after this date.");1==n&&(0===e&&(window.showYesterday=!1),$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("snowDay",{ID:l[e].get("schoolDayID")},{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}else alert("You can't go back one day from here! This is the last day in the available queue.")}}(),E.appendChild(C),s.appendChild(E)}if(v>!p&&(0!=r||1==l[r].get("isActive"))){var x=document.createElement("INPUT");x.type="button",x.className="btn btn-lg btn-primary",x.value="Edit Custom Schedule",x.name=r,x.style.marginRight="10px",x.onclick=function(){var e=r;return function(t){"*"===l[e].get("scheduleType")?localStorage.setItem("customString",l[e].get("customSchedule")):localStorage.setItem("customString","Period 1: \nPeriod 2: \nPeriod 3: \nPeriod 4: \n1st: \n2nd: \n3rd: \nPeriod 6: \nPeriod 7: "),localStorage.setItem("customID",l[e].get("schoolDayID")),localStorage.setItem("customDate",l[e].get("schoolDate")),localStorage.setItem("customDescription",l[e].get("customString")),window.location.replace("./custom")}}(),E.appendChild(x)}s.appendChild(E),o.appendChild(s),a.appendChild(i)}$("#spinnerDiv").html("")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){$("#spinnerDiv").html(""),alert(e)}})},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}var imageFile=null,daysArray="",registerData=null,userCount=0,userArray=new Array,existingUserArray=new Array,testObject=null,customDate=null,customString=null,customID=null,reverseDictionary=new Array,groupsArray=new Array,showYesterday=!0,UserRegisterStructure=Parse.Object.extend("UserRegisterStructure",{create:function(e,t,n,r,a,i,l){e&&t&&a&&i&&n?n!=r?(alert("Your e-mail addresses do not match!"),$("#signupButton").html("Register")):i!=l?(alert("Your passwords do not match!"),$("#signupButton").html("Register")):a.indexOf(" ")>-1?(alert("Your username cannot contain any spaces!"),$("#signupButton").html("Register")):i.indexOf(" ")>-1?(alert("Your password cannot contain any spaces!"),$("#signupButton").html("Register")):($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),$("#signupButton").html("Checking availability..."),Parse.Cloud.run("validateUser",{username:a,email:n},{success:function(r){r>0?(alert("This username or e-mail has already been used. Please try again."),$("#signupButton").html("Register"),$("#spinnerDiv").html("")):Parse.Cloud.run("encryptPassword",{password:i},{success:function(r){for(var i=new UserRegisterStructure,l="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;11>d;d++)l+=o.charAt(Math.floor(Math.random()*o.length));i.save({firstName:e.toString(),lastName:t.toString(),email:n.toString(),username:a.toString(),password:r,key:l},{success:function(e){alert("You have successfully registered your WildcatConnect account! A member of administration will approve your request and you will then receive a confirmation e-mail."),location.reload()},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})):(alert("Please ensure you have correctly filled out all required fields!"),$("#signupButton").html("Register"))}}),NewsArticleStructure=Parse.Object.extend("NewsArticleStructure",{create:function(e,t,n,r,a){if(e&&t&&n&&r&&a){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var i=new Parse.Query("NewsArticleStructure");i.descending("articleID"),i.first({success:function(i){if(i)var l=i.get("articleID")+1;else var l=0;var o=new NewsArticleStructure;null===window.imageFile?o.save({articleID:l,authorString:t,contentURLString:a,dateString:n,hasImage:0,imageFile:null,likes:0,summaryString:r,titleString:e,views:0,isApproved:0},{success:function(e){alert("Wildcat News Story successfully submitted for approval. Please allow 1-2 days for processing."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}}):o.save({articleID:l,authorString:t,contentURLString:a,dateString:n,hasImage:1,imageFile:window.imageFile,likes:0,summaryString:r,titleString:e,views:0,isApproved:0},{success:function(e){alert("Wildcat News Story successfully submitted for approval. Please allow 1-2 days for processing."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),ExtracurricularUpdateStructure=Parse.Object.extend("ExtracurricularUpdateStructure",{create:function(e,t){if(0!==e.length&&t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var n=new Parse.Query("ExtracurricularUpdateStructure");n.descending("extracurricularUpdateID"),n.first({success:function(n){if(n)var r=n.get("extracurricularUpdateID")+1;else var r=0;for(var a=new Array,i=0;i<e.length;i++){var l=new ExtracurricularUpdateStructure;l.set({extracurricularUpdateID:r+i,extracurricularID:e[i],messageString:t}),a.push(l),Parse.Object.saveAll(a,{success:function(e){alert("Update successfully posted."),window.location.replace("./index")},error:function(e){alert(e.message),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),CommunityServiceStructure=Parse.Object.extend("CommunityServiceStructure",{create:function(e,t,n,r,a,i){if(n=new Date(t+" "+n),t=new Date(t),a=new Date(r+" "+a),r=new Date(r),!e||!t||!n||!r||!n||!i||t>r||t.getDate()===r.getDate()&&n>a)alert("Please ensure you have filled out all required fields!");else{$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("CommunityServiceStructure");l.descending("communityServiceID"),l.first({success:function(l){if(l)var o=l.get("communityServiceID")+1;else var o=0;var d=new CommunityServiceStructure,s=new Date(t.getFullYear(),t.getMonth(),t.getDate(),n.getHours(),n.getMinutes(),0,0),c=new Date(r.getFullYear(),r.getMonth(),r.getDate(),a.getHours(),a.getMinutes(),0,0);d.save({communityServiceID:o,commTitleString:e,commSummaryString:i,startDate:s,endDate:c},{success:function(e){alert("Update successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}),EventStructure=Parse.Object.extend("EventStructure",{create:function(e,t,n,r,a){n=new Date(n+" "+r),console.log(n);var i=new Date;if(i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),0,0),e&&t&&n&&r&&a&&!(i>n)){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new EventStructure,o=new Date(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),0,0);l.save({titleString:e,locationString:t,eventDate:o,messageString:a,isApproved:0,userString:Parse.User.current().get("firstName")+" "+Parse.User.current().get("lastName")},{success:function(e){alert("Event successfully submitted for approval. Please allow 1-2 days for processing."),window.location.replace("./index")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),PollStructure=Parse.Object.extend("PollStructure",{create:function(e,t,n,r){if(e&&t&&n&&r){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');for(var a={},i=0;i<r.length;i++)a[r[i].toString()]="0";var l=new Parse.Query("PollStructure");l.descending("pollID"),l.first({success:function(r){if(r)var i=r.get("pollID")+1;else var i=0;var l=new PollStructure;l.save({pollID:parseInt(i).toString(),pollTitle:e,pollQuestion:t,daysActive:parseInt(n),totalResponses:"0",pollMultipleChoices:a},{success:function(e){alert("Poll successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),AlertStructure=Parse.Object.extend("AlertStructure",{create:function(e,t,n,r,a,i){if(a=new Date(r+" "+a),r=new Date(r),e&&t&&n&&("time"!==n||r&&a)){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("AlertStructure");l.descending("alertID"),l.first({success:function(l){var o=l.get("alertID"),d=new AlertStructure,s=new Array;s[0]="January",s[1]="February",s[2]="March",s[3]="April",s[4]="May",s[5]="June",s[6]="July",s[7]="August",s[8]="September",s[9]="October",s[10]="November",s[11]="December";var c=new Date(r.getFullYear(),r.getMonth(),r.getDate(),a.getHours(),a.getMinutes(),0,0),u=new Date;if(u>c&&"time"===n)alert("Whoops! You can't send an alert in the past!"),$("#spinnerDiv").html("");else if("now"===n){var m=s[u.getMonth()]+" "+u.getDate().toString()+", "+u.getFullYear().toString();d.save({alertID:o+1,titleString:e,authorString:t,dateString:m,isReady:1,views:0,alertTime:null,contentString:i,hasTime:0},{success:function(e){alert("Alert successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else if("time"===n){var m=s[c.getMonth()]+" "+c.getDate().toString()+", "+c.getFullYear().toString();d.save({alertID:o+1,titleString:e,authorString:t,dateString:m,isReady:0,views:0,alertTime:c,contentString:i,hasTime:1},{success:function(e){alert("Alert successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}}),ExtracurricularStructure=Parse.Object.extend("ExtracurricularStructure",{create:function(e,t){if(e&&t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var n=new Parse.Query("ExtracurricularStructure");n.descending("extracurricularID"),n.equalTo("titleString",e),n.count({success:function(n){if(n>0)alert("A group with this name has already been registered. Please enter a different name."),$("#spinnerDiv").html("");else{var r=new Parse.Query("ExtracurricularStructure");r.descending("extracurricularID"),r.first({success:function(n){var r=n.get("extracurricularID"),a=new ExtracurricularStructure;a.save({extracurricularID:r+1,titleString:e,descriptionString:t,hasImage:0,meetingIDs:window.daysArray.join("")},{success:function(e){var t=Parse.User.current().get("ownedEC");t.push(e.get("extracurricularID")),Parse.User.current().save({ownedEC:t},{success:function(e){alert("Group successfully registered."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}});$(function(){Parse.$=jQuery,Parse.initialize("cLBOvwh6ZTQYex37DSwxL1Cvg34MMiRWYAB4vqs0","tTcV5Ns1GFdDda44FCcG5XHBDMbLA1sxRUzSnDgW"),$("#logOut").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to log out and end your session?");1==e&&(Parse.User.logOut(),window.location.replace("./login"))}),$("#changePassword").click(function(){var e=confirm("Are you sure you want to change your password?");event.preventDefault(),1==e&&Parse.User.requestPasswordReset(Parse.User.current().get("email"),{success:function(){alert("Check your e-mail for password reset instructions!")},error:function(e){alert("Error: "+e.code+" "+e.message)}})}),$(".form-signin").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value,n=e[1].value;$("#logIn").html("Signing in..."),$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.User.logIn(t,n,{success:function(e){$("#spinnerDiv").html("");var t=Parse.User.current().get("verified");0===t?(localStorage.setItem("key",Parse.User.current().get("key")),localStorage.setItem("username",Parse.User.current().get("username")),window.location.replace("./verify")):window.location.replace("./index")},error:function(e,t){101===t.code&&(alert("Invalid username or password. Please try again."),$("#spinnerDiv").html(""))}})}),$(".form-horizontal").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=new UserRegisterStructure;t.create(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value,e[5].value,e[6].value)}),$(".cancel").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to go back? Any unsaved progress will be lost.");1==e&&history.back()}),$(".cancel-errors").click(function(){event.preventDefault(),history.back()}),$(".cancel-verify").click(function(){event.preventDefault(),window.location.replace("./login")}),$(".cancel-schedule").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to go back? Any unsaved progress will be lost.");1==e&&history.back()}),$(".form-add-news").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Wildcat News Story for administrative approval?");if(1==e){var t=$(this).serializeArray(),n=new NewsArticleStructure;n.create(t[0].value,t[1].value,document.getElementById("date").value,t[2].value,t[3].value)}}),$(".form-add-groupUpdate").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Group Update?");if(1==e){var t=$(this).serializeArray(),n=new ExtracurricularUpdateStructure;n.create(window.groupsArray,t[t.length-1].value)}}),$(".form-add-community").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Community Service Update?");if(1==e){var t=$(this).serializeArray(),n=new CommunityServiceStructure;n.create(t[0].value,t[1].value,t[2].value,t[3].value,t[4].value,t[5].value)}}),$(".form-add-event").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this event for administrative approval?");if(1==e){var t=$(this).serializeArray(),n=new EventStructure;n.create(t[0].value,t[1].value,t[2].value,t[3].value,t[4].value)}}),$(".form-add-poll").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this User Poll?");if(1==e){var t=$(this).serializeArray(),n=new PollStructure;n.create(t[0].value,t[1].value,t[2].value,choicesArray)}}),$(".form-add-alert").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this alert? It will be live to all app users.");if(1==e){var t=$(this).serializeArray(),n=new AlertStructure;n.create(t[0].value,Parse.User.current().get("firstName")+" "+Parse.User.current().get("lastName"),t[1].value,t[2].value,t[3].value,t[4].value)}}),$(".form-add-groupRegister").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to register this new group?");if(1==e){var t=$(this).serializeArray(),n=new ExtracurricularStructure;n.create(t[0].value,t[1].value)}}),$(".form-add-custom").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value,n=e[1].value;if(n){var r=window.confirm("Are you sure you want to save this custom schedule?");if(1==r){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var a=new Parse.Query("SchoolDayStructure");a.equalTo("schoolDayID",parseInt(localStorage.getItem("customID"))),a.first({success:function(e){e.set("customString",t),e.set("customSchedule",n),e.set("scheduleType","*"),e.save(null,{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),window.location.replace("./schedule")},error:function(e){alert(e.code+" - "+e.message)}})},error:function(e){alert(e.code+" - "+e.message)}})}}else alert("No data entered!")}),$(".form-verify").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value;if(t===localStorage.getItem("key").toString()){var n=new Parse.Query(Parse.User);n.equalTo("username",localStorage.getItem("username").toString()),n.first({success:function(e){Parse.User.current().save({verified:1},{success:function(){Parse.User.logOut(),alert("Registration complete! Welcome to WildcatConnect! Please re-enter your login credentials."),window.location.replace("./login")},error:function(e){alert(e.code+" - "+e.message),window.location.replace("./login")}})},error:function(e){alert(e.code+" - "+e.message),window.location.replace("./login")}})}else alert("Incorrect registration key."),Parse.User.logOut(),window.location.replace("./login")}),$(".saveLunch").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to save this breakfast and lunch information?");if(1==e){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=new Array,n=new Parse.Query("SchoolDayStructure");n.equalTo("isActive",1),n.ascending("schoolDayID"),n.find({success:function(e){for(var n=0;n<e.length;n++){var r="#b_"+n.toString(),a=$(r).val(),i="#l_"+n.toString(),l=$(i).val();e[n].set("breakfastString",a),e[n].set("lunchString",l),t.push(e[n])}Parse.Object.saveAll(t,{success:function(e){alert("Breakfasts and lunches successfully updated."),$("#spinnerDiv").html(""),window.location.replace("./lunch")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}),$(".saveLinks").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to save these links? They will be live for all app users.");if(1==e){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=new Parse.Query("UsefulLinkArray");t.ascending("index"),t.find({success:function(e){Parse.Object.destroyAll(e,{success:function(){for(var t=document.getElementById("links"),n=t.getElementsByTagName("table").length,r=new Array,a=!0,i=0;n>i;i++){var l=Parse.Object.extend("UsefulLinkArray"),o=new l,d="#header_"+i.toString(),s=$(d).val();o.set("headerTitle",s),o.set("index",i);for(var c=document.getElementById("table_"+i.toString()).rows,u=[],m=0;m<c.length-1;m++){var p={},g="#title_"+i+"_"+m,v=$(g).val();if(!v){a=!1,alert("Please ensure you have correctly filled all fields!");$(g).css("border-color");$(g).css("border-color","red");break}p.titleString=v,$(g).css("border-color","rgb(51, 51, 51");var h="#link_"+i+"_"+m,f=$(h).val();if(!f){a=!1,alert("Please ensure you have correctly filled all fields!"),$(h).css("border-color","red");break}p.URLString=f,$(h).css("border-color","rgb(51, 51, 51"),u.push(p)}if(1!=a)break;o.set("linksArray",u),r.push(o)}1==a?Parse.Object.saveAll(r,{success:function(e){alert("Links successfully updated."),$("#spinnerDiv").html(""),window.location.replace("./links")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}}):Parse.Object.saveAll(e,{success:function(e){$("#spinnerDiv").html("")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}),$(window).error(function(e,t,n){console.log(e+" - "+t+" - "+n)})});