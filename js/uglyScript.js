function start(e){return function(){window.imageFile=new Parse.File("image.png",e)}}function startTwo(e){return function(){window.daysArray=e}}function loadNewUserTable(){return function(){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("UserRegisterStructure");e.ascending("lastName"),e.find({success:function(e){$("#newLabel").html("New User Requests ("+e.length+")");var r=document.getElementById("newUsers"),t=document.createElement("TABLE"),n=document.createElement("TBODY");$("#newUsers").html(""),t.appendChild(n),t.className="table table-striped";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="Action";var i=document.createElement("TR");n.appendChild(i);for(var l=0;l<a.length;l++){var s=document.createElement("TH");s.width="25%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}window.userArray=new Array;for(var l=0;l<e.length;l++){window.userArray.push(e[l]);var i=document.createElement("TR"),c=document.createElement("TD");c.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(c);var o=document.createElement("TD");o.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(o);var u=document.createElement("TD");u.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(u);var d=document.createElement("TD"),m=document.createElement("INPUT");m.type="button",m.className="approveUser btn btn-lg btn-primary",m.value="Approve",m.name=l,m.style.marginRight="10px",m.onclick=function(){var e=l;return function(r){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=window.userArray[e],n=t.get("password"),a=t.get("key");Parse.Cloud.run("decryptPassword",{password:n},{success:function(e){Parse.Cloud.run("registerUser",{username:t.get("username"),password:e,email:t.get("email"),firstName:t.get("firstName"),lastName:t.get("lastName"),key:a},{success:function(){$("#spinnerDiv").html(""),alert("User approved!"),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e)}})},error:function(e){alert(e.message)}})}}(),d.appendChild(m);var p=document.createElement("INPUT");p.type="button",p.className="approveUser btn btn-lg btn-primary",p.value="Deny",m.name=l,p.style.marginRight="10px",p.onclick=function(){var e=l;return function(r){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=window.userArray[e],n=new Parse.Query("UserRegisterStructure");n.equalTo("username",t.get("username")),n.first({success:function(e){e.destroy({success:function(e){alert("User successfully denied request."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}(),d.appendChild(p),i.appendChild(d),n.appendChild(i),r.appendChild(t)}},error:function(e){alert(e)}})}}function loadExistingUserTable(){return function(){var e=new Parse.Query("User");e.ascending("lastName"),e.find({success:function(e){$("#existingLabel").html("Existing Users ("+e.length+")");var r=document.getElementById("existingUsers"),t=document.createElement("TABLE"),n=document.createElement("TBODY");t.appendChild(n),t.className="table table-striped",t.id="userTable";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="User Type",a[4]="Change Type",a[5]="Action";var i=document.createElement("TR");n.appendChild(i),$("#existingUsers").html("");for(var l=0;l<a.length;l++){var s=document.createElement("TH");s.width="17%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),c=document.createElement("TD");c.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(c);var o=document.createElement("TD");o.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(o);var u=document.createElement("TD");u.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(u);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("userType"))),i.appendChild(d);var m=document.createElement("TD"),p=document.createElement("SELECT");p.name="typeSelect";var v=document.createElement("option");v.value=-1,v.text="NONE SELECTED",p.appendChild(v);for(var g=["Developer","Administration","Faculty"],h=0;h<g.length;h++){var v=document.createElement("option");v.value=h,v.text=g[h],p.appendChild(v)}p.onchange=function(){var r=l;return function(t){var n=g[this.selectedIndex-1];e[r].set("userType",n),e[r].save(null,{success:function(e){e.get("email")===Parse.User.current().get("email")?Parse.User.current().fetch({success:function(){alert("User successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadExistingUserTable())},error:function(e){alert(e.code+" - "+e.message)}}):(alert("User successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadExistingUserTable()))},error:function(e){alert(e.code+" - "+e.message)}})}}(),m.appendChild(p),i.appendChild(m);var f=document.createElement("TD"),w=document.createElement("INPUT");w.type="button",w.className="approveUser btn btn-lg btn-primary",w.value="Delete",w.name=l,w.style.marginRight="10px",w.onclick=function(){var e=l;return function(r){var t=window.existingUserArray[e],n=confirm("Are you sure you want to delete "+t.get("firstName")+" "+t.get("lastName")+" as a user?");event.preventDefault(),1==n&&($("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("deleteUser",{username:t.get("username")},{success:function(){alert("User successfully deleted."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}}(),f.appendChild(w),i.appendChild(f),n.appendChild(i),r.appendChild(t)}$("#spinnerDiv").html("")},error:function(e){alert(e)}})}}function loadScheduleTable(){return function(){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=[],r=new Parse.Query("ScheduleType");r.ascending("typeID"),r.find({success:function(r){for(var t=0;t<r.length;t++){var n=r[t].get("typeID"),a=r[t].get("fullScheduleString");e[n]=a,reverseDictionary[t]=n}var i=new Parse.Query("SchoolDayStructure");i.equalTo("isActive",1),i.ascending("schoolDayID"),i.find({success:function(r){$("#titleLabel").html("Upcoming School Days ("+r.length+")");var t=document.getElementById("schedules"),n=document.createElement("TABLE"),a=document.createElement("TBODY");n.appendChild(a),n.className="table table-striped";var i=new Array;i[0]="Date",i[1]="Schedule Type",i[2]="Change Type",i[3]="Custom Action";var l=document.createElement("TR");a.appendChild(l),$("#schedules").html("");for(var s=0;s<i.length;s++){var c=document.createElement("TH");c.width="25%",c.appendChild(document.createTextNode(i[s])),l.appendChild(c)}window.existingUserArray=new Array;for(var s=0;s<r.length;s++){window.existingUserArray.push(r[s]);var l=document.createElement("TR"),o=document.createElement("TD"),u=r[s].get("schoolDate").split("-"),d=new Date(u[2],u[0]-1,u[1]),m=d.toString("dddd, MMMM d, yyyy");o.appendChild(document.createTextNode(m)),l.appendChild(o);var p=r[s].get("scheduleType");if("*"===p){var v=document.createElement("TD");v.appendChild(document.createTextNode("CUSTOM SCHEDULE")),l.appendChild(v)}else{var g=e[p],v=document.createElement("TD");v.appendChild(document.createTextNode(g)),l.appendChild(v)}var h=document.createElement("TD"),f=document.createElement("SELECT");f.name="typeSelect";var w=document.createElement("option");w.value=-1,w.text="NONE SELECTED",f.appendChild(w);for(var y=0;y<Object.keys(e).length;y++){var w=document.createElement("option");w.value=y,w.text=e[Object.keys(e)[y]],f.appendChild(w)}f.onchange=function(){var e=s;return function(t){var n=reverseDictionary[this.selectedIndex-1];r[e].set("scheduleType",n),r[e].set("customSchedule","None."),r[e].save(null,{success:function(e){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e.code+" - "+e.message)}})}}(),h.appendChild(f),l.appendChild(h);var D=document.createElement("TD"),P=document.createElement("INPUT");P.type="button",P.className="approveUser btn btn-lg btn-primary",P.value="Go Back 1 Day, Starting Here",P.name=s,P.style.marginBottom="10px",P.onclick=function(){var e=s;return function(t){e!=r.length-1?($("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("goBackOneDayFromStructure",{ID:r[e].get("schoolDayID")},{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})):alert("You can't go back one day from here! This is the last day in the available queue.")}}(),D.appendChild(P),l.appendChild(D);var U=document.createElement("INPUT");U.type="button",U.className="approveUser btn btn-lg btn-primary",U.value="Edit Custom Schedule",P.name=s,U.style.marginRight="10px",U.onclick=function(){var e=s;return function(t){window.customDate=r[e].get("schoolDate"),"*"===r[e].get("scheduleType")?window.customString=r[e].get("customSchedule"):window.customString="Period 1: \nPeriod 2: \nPeriod 3: \nPeriod 4: \n1st: \n2nd: \n3rd: \nPeriod 6: \nPeriod 7: ",window.customID=r[e].get("schoolDayID");var n=new CustomView;n.render(),$(".main-container").html(n.el)}}(),D.appendChild(U),l.appendChild(D),a.appendChild(l),t.appendChild(n)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}var imageFile=null,daysArray="",registerData=null,userCount=0,userArray=new Array,existingUserArray=new Array,testObject=null,customDate=null,customString=null,customID=null,reverseDictionary=new Array,CustomView=Parse.View.extend({template:Handlebars.compile($("#custom-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){e.preventDefault();var r=($(e.target).serializeArray(),new ScheduleView);r.render(),$(".main-container").html(r.el)},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=r[0].value;if(t){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var n=new Parse.Query("SchoolDayStructure");n.equalTo("schoolDayID",window.customID),n.first({success:function(e){e.set("customSchedule",t),e.set("scheduleType","*"),e.save(null,{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html("");var e=new ScheduleView;e.render(),$(".main-container").html(e.el)},error:function(e){alert(e.code+" - "+e.message)}})},error:function(e){alert(e.code+" - "+e.message)}})}else alert("No data entered!")},render:function(){this.$el.html(this.template())}}),ScheduleView=Parse.View.extend({template:Handlebars.compile($("#schedule-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();$(e.target).serializeArray()},render:function(){this.$el.html(this.template())}}),AdminWelcomeView=Parse.View.extend({template:Handlebars.compile($("#admin-welcome-tpl").html()),events:{"click .add-news":"addNews","click .add-ec":"addEC","click .add-cs":"addCS","click .add-poll":"addPoll","click .add-alert":"addAlert","click .register-ec":"registerEC","click .user":"user","click .schedule":"schedule"},addNews:function(){var e=new AddNewsView;e.render(),$(".main-container").html(e.el)},addEC:function(){var e=new AddECView;e.render(),$(".main-container").html(e.el)},addCS:function(){var e=new AddCSView;e.render(),$(".main-container").html(e.el)},addPoll:function(){var e=new AddPollView;e.render(),$(".main-container").html(e.el)},addAlert:function(){var e=new AddAlertView;e.render(),$(".main-container").html(e.el)},registerEC:function(){var e=new RegisterECView;e.render(),$(".main-container").html(e.el)},user:function(){var e=new UserView;e.render(),$(".main-container").html(e.el)},schedule:function(){var e=new ScheduleView;e.render(),$(".main-container").html(e.el)},render:function(){var e=this.model.toJSON();this.$el.html(this.template(e))}}),FacultyWelcomeView=Parse.View.extend({template:Handlebars.compile($("#faculty-welcome-tpl").html()),events:{"click .add-news":"addNews","click .add-ec":"addEC","click .register-ec":"registerEC"},addNews:function(){var e=new AddNewsView;e.render(),$(".main-container").html(e.el)},addEC:function(){var e=new AddECView;e.render(),$(".main-container").html(e.el)},registerEC:function(){var e=new RegisterECView;e.render(),$(".main-container").html(e.el)},render:function(){var e=this.model.toJSON();this.$el.html(this.template(e))}}),UserRegisterStructure=Parse.Object.extend("UserRegisterStructure",{create:function(e,r,t,n,a){e&&r&&n&&a&&t?($("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),$("#signupButton").html("Checking availability..."),Parse.Cloud.run("validateUser",{username:n,email:t},{success:function(i){i>0?(alert("This username or e-mail has already been used. Please try again."),$("#signupButton").html("Register"),$("#spinnerDiv").html("")):Parse.Cloud.run("encryptPassword",{password:a},{success:function(a){for(var i=new UserRegisterStructure,l="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;11>c;c++)l+=s.charAt(Math.floor(Math.random()*s.length));i.save({firstName:e.toString(),lastName:r.toString(),email:t.toString(),username:n.toString(),password:a,key:l},{success:function(e){alert("You have successfully registered your WildcatConnect account! A member of administration will approve your request and you will then receive a confirmation e-mail."),location.reload()},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})):(alert("Please ensure you have correctly filled out all required fields!"),$("#signupButton").html("Register"))}}),LoginView=Parse.View.extend({template:Handlebars.compile($("#login-tpl").html()),events:{"submit .form-signin":"login","submit .form-horizontal":"register","click .forgot":"forgot"},register:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new UserRegisterStructure;t.create(r[0].value,r[1].value,r[2].value,r[3].value,r[4].value)},login:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=r[0].value,n=r[1].value;$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.User.logIn(t,n,{success:function(e){$("#spinnerDiv").html("");var r=Parse.User.current().get("verified");if(0===r){var t=new VerifyView;t.render(),$(".main-container").html(t.el)}else{if("Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var n=new AdminWelcomeView({model:Parse.User.current()});n.render(),$(".main-container").html(n.el)}else{var n=new FacultyWelcomeView({model:Parse.User.current()});n.render(),$(".main-container").html(n.el)}var a=document.getElementById("navbar");a.innerHTML=a.innerHTML+'<ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Account <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="" id="changePassword">Change Password</a></li><li><a href="mailto:support@wildcatconnect.org">Report an issue</a></li><li role="separator" class="divider"></li><li><a href="" id="logOut">Log Out</a></li></ul></li></ul>',location.reload()}},error:function(e,r){101===r.code&&(alert("Invalid username or password. Please try again."),$("#spinnerDiv").html(""))}})},forgot:function(e){e.preventDefault();var r=new ForgotView;r.render(),$(".main-container").html(r.el)},render:function(){this.$el.html(this.template())}}),ForgotView=Parse.View.extend({template:Handlebars.compile($("#forgot-tpl").html()),events:{"submit .form-signin":"submit","click .cancel":"cancel"},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=r[0].value;t?Parse.Cloud.run("recoverUser",{email:t},{success:function(){alert("An e-mail will be sent to you at "+t+" with password reset instructions."),location.reload()},error:function(e){alert(e.code+" - "+e.message)}}):alert("You must enter a valid e-mail address.")},cancel:function(e){e.preventDefault();var r=new LoginView;r.render(),$(".main-container").html(r.el)},render:function(){this.$el.html(this.template())}}),VerifyView=Parse.View.extend({template:Handlebars.compile($("#verify-tpl").html()),events:{"submit .form-signin":"submit","click .cancel":"cancel"},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=r[0].value;if(t===Parse.User.current().get("key"))alert("Registration complete! Welcome to WildcatConnect!"),Parse.User.current().save({verified:1},{success:function(e){if("Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}var t=document.getElementById("navbar");t.innerHTML=t.innerHTML+'<ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Account <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="" id="changePassword">Change Password</a></li><li><a href="mailto:support@wildcatconnect.org">Report an issue</a></li><li role="separator" class="divider"></li><li><a href="" id="logOut">Log Out</a></li></ul></li></ul>',location.reload()},error:function(e){alert(e.code+" - "+e.message),Parse.User.logOut();var r=new LoginView;r.render(),$(".main-container").html(r.el);var t=document.getElementById("navbar");t.innerHTML=""}});else{alert("Incorrect registration key."),Parse.User.logOut();var n=new LoginView;n.render(),$(".main-container").html(n.el);var a=document.getElementById("navbar");a.innerHTML=""}},cancel:function(e){e.preventDefault(),event.preventDefault(),Parse.User.logOut();var r=new LoginView;r.render(),$(".main-container").html(r.el);var t=document.getElementById("navbar");t.innerHTML=""},render:function(){this.$el.html(this.template())}}),AddNewsView=Parse.View.extend({template:Handlebars.compile($("#add-news-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new NewsArticleStructure;t.create(r[0].value,r[1].value,document.getElementById("date").value,r[2].value,r[3].value)},render:function(){this.$el.html(this.template())}}),AddECView=Parse.View.extend({template:Handlebars.compile($("#add-ec-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new ExtracurricularUpdateStructure;t.create(r[0].value,r[1].value)},render:function(){this.$el.html(this.template())}}),AddCSView=Parse.View.extend({template:Handlebars.compile($("#add-cs-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new CommunityServiceStructure;t.create(r[0].value,r[1].value,r[2].value,r[3].value,r[4].value,r[5].value)},render:function(){this.$el.html(this.template())}}),AddPollView=Parse.View.extend({template:Handlebars.compile($("#add-poll-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new PollStructure;t.create(r[0].value,r[1].value,r[2].value,choicesArray)},render:function(){this.$el.html(this.template())}}),AddAlertView=Parse.View.extend({template:Handlebars.compile($("#add-alert-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new AlertStructure;t.create(r[0].value,Parse.User.current().get("firstName")+" "+Parse.User.current().get("lastName"),r[1].value,r[2].value,r[3].value,r[4].value)},render:function(){this.$el.html(this.template())}}),RegisterECView=Parse.View.extend({template:Handlebars.compile($("#reg-ec-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();var r=$(e.target).serializeArray(),t=new ExtracurricularStructure;t.create(r[0].value,r[1].value)},render:function(){this.$el.html(this.template())}}),UserView=Parse.View.extend({template:Handlebars.compile($("#user-tpl").html()),events:{"submit .form-add":"submit","click .cancel":"cancel"},cancel:function(e){if(e.preventDefault(),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el)}},submit:function(e){e.preventDefault();$(e.target).serializeArray()},render:function(){this.$el.html(this.template())}}),NewsArticleStructure=Parse.Object.extend("NewsArticleStructure",{create:function(e,r,t,n,a){if(e&&r&&t&&n&&a){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var i=new Parse.Query("NewsArticleStructure");i.descending("articleID"),i.first({success:function(i){if(i)var l=i.get("articleID")+1;else var l=0;var s=new NewsArticleStructure;null===window.imageFile?s.save({articleID:l,authorString:r,contentURLString:a,dateString:t,hasImage:0,imageFile:null,likes:0,summaryString:n,titleString:e,views:0},{success:function(e){if(alert("Article successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),$("#spinnerDiv").html("")}}):s.save({articleID:l+1,authorString:r,contentURLString:a,dateString:t,hasImage:1,imageFile:window.imageFile,likes:0,summaryString:n,titleString:e,views:0},{success:function(e){if(alert("Article successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),ExtracurricularUpdateStructure=Parse.Object.extend("ExtracurricularUpdateStructure",{create:function(e,r){if(parseInt(e)<0||!r)alert("Please ensure you have filled out all required fields!");else{$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=new Parse.Query("ExtracurricularUpdateStructure");t.descending("extracurricularUpdateID"),t.first({success:function(t){if(t)var n=t.get("extracurricularUpdateID")+1;else var n=0;var a=new ExtracurricularUpdateStructure;a.save({extracurricularUpdateID:n,extracurricularID:parseInt(e),messageString:r},{success:function(e){if(alert("Update successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e.message),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}),CommunityServiceStructure=Parse.Object.extend("CommunityServiceStructure",{create:function(e,r,t,n,a,i){if(t=new Date(r+" "+t),r=new Date(r),a=new Date(n+" "+a),n=new Date(n),!e||!r||!t||!n||!t||!i||r>n||r.getDate()===n.getDate()&&t>a)alert("Please ensure you have filled out all required fields!");else{$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("CommunityServiceStructure");l.descending("communityServiceID"),l.first({success:function(l){if(l)var s=l.get("communityServiceID")+1;else var s=0;var c=new CommunityServiceStructure,o=new Date(r.getFullYear(),r.getMonth(),r.getDate(),t.getHours(),t.getMinutes(),0,0),u=new Date(n.getFullYear(),n.getMonth(),n.getDate(),a.getHours(),a.getMinutes(),0,0);c.save({communityServiceID:s,commTitleString:e,commSummaryString:i,startDate:o,endDate:u},{success:function(e){if(alert("Update successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}),PollStructure=Parse.Object.extend("PollStructure",{create:function(e,r,t,n){if(e&&r&&t&&n){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');for(var a={},i=0;i<n.length;i++)a[n[i].toString()]="0";var l=new Parse.Query("PollStructure");l.descending("pollID"),l.first({success:function(n){if(n)var i=n.get("pollID");else var i=0;var l=new PollStructure;l.save({pollID:parseInt(i).toString(),pollTitle:e,pollQuestion:r,daysActive:parseInt(t),totalResponses:"0",pollMultipleChoices:a},{success:function(e){if(alert("Poll successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),AlertStructure=Parse.Object.extend("AlertStructure",{create:function(e,r,t,n,a,i){if(a=new Date(n+" "+a),n=new Date(n),e&&r&&t&&("time"!==t||n&&a)){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("AlertStructure");l.descending("alertID"),l.first({success:function(l){var s=l.get("alertID"),c=new AlertStructure,o=new Array;o[0]="January",o[1]="February",o[2]="March",o[3]="April",o[4]="May",o[5]="June",o[6]="July",o[7]="August",o[8]="September",o[9]="October",o[10]="November",o[11]="December";var u=new Date(n.getFullYear(),n.getMonth(),n.getDate(),a.getHours(),a.getMinutes(),0,0),d=new Date;if(d>u)alert("Whoops! You can't send an alert in the past!"),$("#spinnerDiv").html("");else if("now"===t){var m=o[d.getMonth()]+" "+d.getDate().toString()+", "+d.getFullYear().toString();c.save({alertID:s+1,titleString:e,authorString:r,dateString:m,isReady:1,views:0,alertTime:null,contentString:i,hasTime:0},{success:function(e){if(alert("Alert successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),
$("#spinnerDiv").html("")}})}else if("time"===t){var m=o[u.getMonth()]+" "+u.getDate().toString()+", "+u.getFullYear().toString();c.save({alertID:s+1,titleString:e,authorString:r,dateString:m,isReady:0,views:0,alertTime:u,contentString:i,hasTime:1},{success:function(e){if(alert("Alert successfully posted."),"Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}}),ExtracurricularStructure=Parse.Object.extend("ExtracurricularStructure",{create:function(e,r){if(e&&r){$("#spinnerDiv").html('<a><img src="./spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=new Parse.Query("ExtracurricularStructure");t.descending("extracurricularID"),t.first({success:function(t){var n=t.get("extracurricularID"),a=new ExtracurricularStructure;a.save({extracurricularID:n+1,titleString:e,descriptionString:r,hasImage:0,imageFile:null,meetingIDs:window.daysArray.join(""),channelString:"E"+(n+1).toString()},{success:function(e){if("Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){alert("Group successfully registered.");var r=new AdminWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")}else{var t=Parse.User.current().get("ownedEC");t.push("E"+e.get("extracurricularID").toString()),Parse.User.current().save({ownedEC:t},{success:function(e){alert("Group successfully registered.");var r=new FacultyWelcomeView({model:Parse.User.current()});r.render(),$(".main-container").html(r.el),$("#spinnerDiv").html("")},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}});$(function(){if(Parse.$=jQuery,Parse.initialize("cLBOvwh6ZTQYex37DSwxL1Cvg34MMiRWYAB4vqs0","tTcV5Ns1GFdDda44FCcG5XHBDMbLA1sxRUzSnDgW"),Parse.User.current()){var e=Parse.User.current().get("verified");if(0===e){var r=new VerifyView;r.render(),$(".main-container").html(r.el)}else{if("Administration"===Parse.User.current().get("userType")||"Developer"===Parse.User.current().get("userType")){var t=new AdminWelcomeView({model:Parse.User.current()});t.render(),$(".main-container").html(t.el)}else{var t=new FacultyWelcomeView({model:Parse.User.current()});t.render(),$(".main-container").html(t.el)}var n=document.getElementById("navbar");n.innerHTML=n.innerHTML+'<ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Account <span class="caret"></span></a><ul class="dropdown-menu"><li><a href="" id="changePassword">Change Password</a></li><li><a href="mailto:support@wildcatconnect.org">Report an issue</a></li><li role="separator" class="divider"></li><li><a href="" id="logOut">Log Out</a></li></ul></li></ul>'}}else{var a=new LoginView;a.render(),$(".main-container").html(a.el)}$("#logOut").click(function(){event.preventDefault(),Parse.User.logOut();var e=new LoginView;e.render(),$(".main-container").html(e.el);var r=document.getElementById("navbar");r.innerHTML=""}),$("#changePassword").click(function(){var e=confirm("Are you sure you want to reset your password?");event.preventDefault(),1==e&&Parse.User.requestPasswordReset(Parse.User.current().get("email"),{success:function(){alert("Check your e-mail for password reset instructions!")},error:function(e){alert("Error: "+e.code+" "+e.message)}})})});