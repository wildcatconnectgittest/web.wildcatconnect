function start(e){return function(){window.imageFile=new Parse.File("image.png",e)}}function startTwo(e){return function(){window.daysArray=e}}function startThree(e){return function(){window.groupsArray=e}}function customView(){return function(){var e=localStorage.getItem("customDate").split("-"),t=new Date(e[2],e[0]-1,e[1]),r=t.toString("dddd, MMMM d, yyyy");$("#topLabel").html("Custom Schedule - "+r),$("#customArea").val(localStorage.getItem("customString")),$("#scheduleDescription").val(localStorage.getItem("customDescription"))}}function loadNewUserTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("UserRegisterStructure");e.ascending("lastName"),e.find({success:function(e){$("#newLabel").html("New User Requests ("+e.length+")");var t=document.getElementById("newUsers"),r=document.createElement("TABLE"),n=document.createElement("TBODY");$("#newUsers").html(""),r.appendChild(n),r.className="table table-striped";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="Action";var i=document.createElement("TR");n.appendChild(i);for(var l=0;l<a.length;l++){var s=document.createElement("TH");s.width="25%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}window.userArray=new Array;for(var l=0;l<e.length;l++){window.userArray.push(e[l]);var i=document.createElement("TR"),o=document.createElement("TD");o.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(o);var c=document.createElement("TD");c.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(c);var u=document.createElement("TD");u.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(u);var d=document.createElement("TD"),m=document.createElement("INPUT");m.type="button",m.className="approveUser btn btn-lg btn-primary",m.value="Approve",m.name=l,m.style.marginRight="10px",m.onclick=function(){var e=l;return function(t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=window.userArray[e],n=r.get("password"),a=r.get("key");Parse.Cloud.run("decryptPassword",{password:n},{success:function(e){Parse.Cloud.run("registerUser",{username:r.get("username"),password:e,email:r.get("email"),firstName:r.get("firstName"),lastName:r.get("lastName"),key:a},{success:function(){$("#spinnerDiv").html(""),alert("User approved!"),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e.message),$("#spinnerDiv").html("")}})}}(),d.appendChild(m);var p=document.createElement("INPUT");p.type="button",p.className="btn btn-lg btn-primary",p.value="Deny",m.name=l,p.style.marginRight="10px",p.style.backgroundColor="red",p.style.borderColor="red",p.onclick=function(){var e=l;return function(t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=window.userArray[e],n=new Parse.Query("UserRegisterStructure");n.equalTo("username",r.get("username")),n.first({success:function(e){e.destroy({success:function(e){alert("User successfully denied request."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}(),d.appendChild(p),i.appendChild(d),n.appendChild(i),t.appendChild(r)}},error:function(e){alert(e)}})}}function loadExistingUserTable(){return function(){var e=new Parse.Query("User");e.ascending("lastName"),e.find({success:function(e){$("#existingLabel").html("Existing Users ("+e.length+")");var t=document.getElementById("existingUsers"),r=document.createElement("TABLE"),n=document.createElement("TBODY");r.appendChild(n),r.className="table table-striped",r.id="userTable";var a=new Array;a[0]="Last Name",a[1]="First Name",a[2]="E-Mail",a[3]="User Type",a[4]="Change Type",a[5]="Action";var i=document.createElement("TR");n.appendChild(i),$("#existingUsers").html("");for(var l=0;l<a.length;l++){var s=document.createElement("TH");s.width="17%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),o=document.createElement("TD");o.appendChild(document.createTextNode(e[l].get("lastName"))),i.appendChild(o);var c=document.createElement("TD");c.appendChild(document.createTextNode(e[l].get("firstName"))),i.appendChild(c);var u=document.createElement("TD");u.innerHTML='<a href="mailto:'+e[l].get("email")+'">'+e[l].get("email")+"</a>",i.appendChild(u);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("userType"))),i.appendChild(d);var m=document.createElement("TD"),p=document.createElement("SELECT");p.name="typeSelect";var g=document.createElement("option");g.value=-1,g.text="NONE SELECTED",p.appendChild(g);for(var v=["Developer","Administration","Faculty","Lunch Manager"],h=0;h<v.length;h++){var g=document.createElement("option");g.value=h,g.text=v[h],p.appendChild(g)}p.onchange=function(){var t=l;return function(r){var n=window.confirm("Are you sure you want to update this user?");if(1==n){var a=v[this.selectedIndex-1];e[t].set("userType",a),e[t].save(null,{success:function(e){e.get("email")===Parse.User.current().get("email")?Parse.User.current().fetch({success:function(){alert("User successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadExistingUserTable())},error:function(e){alert(e.code+" - "+e.message)}}):(alert("User successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadExistingUserTable()))},error:function(e){alert(e.code+" - "+e.message)}})}}}(),m.appendChild(p),i.appendChild(m);var f=document.createElement("TD"),y=document.createElement("INPUT");y.type="button",y.className="btn btn-lg btn-primary",y.value="Delete",y.name=l,y.style.marginRight="10px",y.style.backgroundColor="red",y.style.borderColor="red",y.onclick=function(){var e=l;return function(t){var r=window.existingUserArray[e];if(r.get("username")!=Parse.User.current().get("username").toString()){var n=confirm("Are you sure you want to delete "+r.get("firstName")+" "+r.get("lastName")+" as a user?");event.preventDefault(),1==n&&($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("deleteUser",{username:r.get("username")},{success:function(){alert("User successfully deleted."),$("#spinnerDiv").html(""),$(document).ready(loadNewUserTable()),$(document).ready(loadExistingUserTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}else alert("You cannot delete yourself as a user!"),$("#spinnerDiv").html("")}}(),f.appendChild(y),i.appendChild(f),n.appendChild(i),t.appendChild(r)}$("#spinnerDiv").html("")},error:function(e){alert(e)}})}}function loadLunchTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("SchoolDayStructure");e.equalTo("isActive",1),e.ascending("schoolDayID");new Array;e.find({success:function(e){$("#titleLabel").html("Available School Days ("+e.length+")");var t=document.getElementById("schedules"),r=document.createElement("TABLE"),n=document.createElement("TBODY");r.appendChild(n),r.className="table table-striped";var a=new Array;a[0]="Date",a[1]="Breakfast",a[2]="Lunch";var i=document.createElement("TR");n.appendChild(i),$("#schedules").html("");for(var l=0;l<a.length;l++){var s=document.createElement("TH");0==l?s.width="20%":s.width="40%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}window.existingUserArray=new Array;for(var l=0;l<e.length;l++){window.existingUserArray.push(e[l]);var i=document.createElement("TR"),o=document.createElement("TD"),c=e[l].get("schoolDate").split("-"),u=new Date(c[2],c[0]-1,c[1]),d=u.toString("dddd, MMMM d, yyyy");o.appendChild(document.createTextNode(d)),i.appendChild(o);var m=document.createElement("TD"),p=document.createElement("TEXTAREA");p.value=e[l].get("breakfastString"),p["class"]="form-control",p.style.display="block",p.style.width="100%",p.style.overflowY="scroll",p.style.resize="none",p.id="b_"+l,m.appendChild(p),i.appendChild(m);var g=document.createElement("TD"),v=document.createElement("TEXTAREA");v.value=e[l].get("lunchString"),v["class"]="form-control",v.style.display="block",v.style.width="100%",v.style.overflowY="scroll",v.style.resize="none",v.id="l_"+l,g.appendChild(v),i.appendChild(g),n.appendChild(i),t.appendChild(r)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadErrorTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=new Parse.Query("ErrorStructure");e.descending("createdAt"),e.find({success:function(e){$("#titleLabel").html("Recent iOS App Errors and Crashes ("+e.length+")");var t=document.getElementById("errors"),r=document.createElement("TABLE"),n=document.createElement("TBODY");r.appendChild(n),r.className="table table-striped";var a=new Array;a[0]="Date",a[1]="Name",a[2]="Message",a[3]="Device Token",a[4]="Username",a[5]="Action";var i=document.createElement("TR");n.appendChild(i),$("#errors").html("");for(var l=0;l<a.length;l++){var s=document.createElement("TH");s.width="16%",s.appendChild(document.createTextNode(a[l])),i.appendChild(s)}for(var l=0;l<e.length;l++){var i=document.createElement("TR"),o=document.createElement("TD"),c=e[l].createdAt,u=c.toString("dddd, MMMM d, yyyy @ h:mm tt");o.appendChild(document.createTextNode(u)),i.appendChild(o);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("nameString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("infoString"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("deviceToken"))),i.appendChild(d);var d=document.createElement("TD");d.appendChild(document.createTextNode(e[l].get("username"))),i.appendChild(d);var d=document.createElement("TD"),m=document.createElement("INPUT");m.type="button",m.className="btn btn-lg btn-primary",m.value="Delete",m.name=l,m.style.marginBottom="10px",m.style.backgroundColor="red",m.style.borderColor="red",m.onclick=function(){var t=l;return function(r){var n=window.confirm("Are you sure you want to delete this error?");1==n&&e[t].destroy({success:function(){alert("Error successfully deleted."),$(document).ready(loadErrorTable())},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}(),d.appendChild(m),i.appendChild(d),n.appendChild(i),t.appendChild(r)}$("#spinnerDiv").html("")},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}function loadScheduleTable(){return function(){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var e=[],t=new Parse.Query("ScheduleType");t.ascending("typeID"),t.find({success:function(t){for(var r=0;r<t.length;r++){var n=t[r].get("typeID"),a=t[r].get("fullScheduleString");e[n]=a,reverseDictionary[r]=n}var i=new Parse.Query("SchoolDayStructure");i.equalTo("isActive",1),i.ascending("schoolDayID");var l=new Array;i.find({success:function(t){var r=new Parse.Query("SchoolDayStructure");r.equalTo("isActive",0),r.descending("schoolDayID"),r.first({success:function(r){r.get("scheduleType")!=t[0].get("scheduleType")&&l.push(r);for(var n=0;n<t.length;n++)l.push(t[n]);$("#titleLabel").html("Available School Days ("+l.length+")");var a=document.getElementById("schedules"),i=document.createElement("TABLE"),s=document.createElement("TBODY");i.appendChild(s),i.className="table table-striped";var o=new Array;o[0]="Date",o[1]="Schedule Type",o[2]="Change Type",o[3]="Custom Action";var c=document.createElement("TR");s.appendChild(c),$("#schedules").html("");for(var n=0;n<o.length;n++){var u=document.createElement("TH");u.width="25%",u.appendChild(document.createTextNode(o[n])),c.appendChild(u)}window.existingUserArray=new Array;for(var n=0;n<l.length;n++){window.existingUserArray.push(l[n]);var c=document.createElement("TR"),d=document.createElement("TD"),m=l[n].get("schoolDate").split("-"),p=new Date(m[2],m[0]-1,m[1]),g=p.toString("dddd, MMMM d, yyyy");d.appendChild(document.createTextNode(g));var v=new Date,h=v.toString("dddd, MMMM d, yyyy");h===g?d.style.color="red":0==n&&d.appendChild(document.createTextNode(" - LAST SCHOOL DAY")),c.appendChild(d);var f=l[n].get("scheduleType");if("*"===f){var y=document.createElement("TD");y.appendChild(document.createTextNode("CUSTOM SCHEDULE - "+l[n].get("customString"))),y.style.fontWeight="bold",c.appendChild(y)}else{var w=e[f],y=document.createElement("TD");y.appendChild(document.createTextNode(w)),c.appendChild(y)}var D=document.createElement("TD"),S=document.createElement("SELECT");S.name="typeSelect";var T=document.createElement("option");T.value=-1,T.text="NONE SELECTED",S.appendChild(T);for(var x=0;x<Object.keys(e).length;x++){var T=document.createElement("option");T.value=x,T.text=e[Object.keys(e)[x]],S.appendChild(T)}S.onchange=function(){var e=n;return function(t){var r=window.confirm("Are you sure you want to edit this day's schedule?");if(1==r){var n=reverseDictionary[this.selectedIndex-1];l[e].set("scheduleType",n),l[e].set("customSchedule","None."),l[e].set("customString",""),l[e].save(null,{success:function(e){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}}}(),D.appendChild(S),c.appendChild(D);var C=document.createElement("TD");if(2>n){var E=document.createElement("INPUT");E.type="button",E.className="btn btn-lg btn-primary",E.value="Snow Day",E.name=n,E.style.marginBottom="10px",E.onclick=function(){var e=n;return function(t){if(e!=l.length-1){var r=window.confirm("Are you sure you want to make this day a snow day? This will affect all schedules after this date.");1==r&&(0===e&&(window.showYesterday=!1),$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.Cloud.run("snowDay",{ID:l[e].get("schoolDayID")},{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),$(document).ready(loadScheduleTable())},error:function(e){alert(e),$("#spinnerDiv").html("")}}))}else alert("You can't go back one day from here! This is the last day in the available queue.")}}(),C.appendChild(E),c.appendChild(C)}var b=document.createElement("INPUT");b.type="button",b.className="btn btn-lg btn-primary",b.value="Edit Custom Schedule",E.name=n,b.style.marginRight="10px",b.onclick=function(){var e=n;return function(t){"*"===l[e].get("scheduleType")?localStorage.setItem("customString",l[e].get("customSchedule")):localStorage.setItem("customString","Period 1: \nPeriod 2: \nPeriod 3: \nPeriod 4: \n1st: \n2nd: \n3rd: \nPeriod 6: \nPeriod 7: "),localStorage.setItem("customID",l[e].get("schoolDayID")),localStorage.setItem("customDate",l[e].get("schoolDate")),localStorage.setItem("customDescription",l[e].get("customString")),window.location.replace("./custom")}}(),C.appendChild(b),c.appendChild(C),s.appendChild(c),a.appendChild(i)}$("#spinnerDiv").html("")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){$("#spinnerDiv").html(""),alert(e)}})},error:function(e){$("#spinnerDiv").html(""),alert(e)}})}}var imageFile=null,daysArray="",registerData=null,userCount=0,userArray=new Array,existingUserArray=new Array,testObject=null,customDate=null,customString=null,customID=null,reverseDictionary=new Array,groupsArray=new Array,showYesterday=!0,UserRegisterStructure=Parse.Object.extend("UserRegisterStructure",{create:function(e,t,r,n,a,i,l){e&&t&&a&&i&&r?r!=n?(alert("Your e-mail addresses do not match!"),$("#signupButton").html("Register")):i!=l?(alert("Your passwords do not match!"),$("#signupButton").html("Register")):-1===r.indexOf("weymouthschools.org")?(alert("Your e-mail address is not a valid faculty address!"),$("#signupButton").html("Register")):a.indexOf(" ")>-1?(alert("Your username cannot contain any spaces!"),$("#signupButton").html("Register")):i.indexOf(" ")>-1?(alert("Your password cannot contain any spaces!"),$("#signupButton").html("Register")):($("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),$("#signupButton").html("Checking availability..."),Parse.Cloud.run("validateUser",{username:a,email:r},{success:function(n){n>0?(alert("This username or e-mail has already been used. Please try again."),$("#signupButton").html("Register"),$("#spinnerDiv").html("")):Parse.Cloud.run("encryptPassword",{password:i},{success:function(n){for(var i=new UserRegisterStructure,l="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;11>o;o++)l+=s.charAt(Math.floor(Math.random()*s.length));i.save({firstName:e.toString(),lastName:t.toString(),email:r.toString(),username:a.toString(),password:n,key:l},{success:function(e){alert("You have successfully registered your WildcatConnect account! A member of administration will approve your request and you will then receive a confirmation e-mail."),location.reload()},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#signupButton").html("Register"),$("#spinnerDiv").html("")}})):(alert("Please ensure you have correctly filled out all required fields!"),$("#signupButton").html("Register"))}}),NewsArticleStructure=Parse.Object.extend("NewsArticleStructure",{create:function(e,t,r,n,a){if(e&&t&&r&&n&&a){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var i=new Parse.Query("NewsArticleStructure");i.descending("articleID"),i.first({success:function(i){if(i)var l=i.get("articleID")+1;else var l=0;var s=new NewsArticleStructure;null===window.imageFile?s.save({articleID:l,authorString:t,contentURLString:a,dateString:r,hasImage:0,imageFile:null,likes:0,summaryString:n,titleString:e,views:0},{success:function(e){alert("Article successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}}):s.save({articleID:l,authorString:t,contentURLString:a,dateString:r,hasImage:1,imageFile:window.imageFile,likes:0,summaryString:n,titleString:e,views:0},{success:function(e){alert("Article successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),ExtracurricularUpdateStructure=Parse.Object.extend("ExtracurricularUpdateStructure",{create:function(e,t){if(0!==e.length&&t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=new Parse.Query("ExtracurricularUpdateStructure");r.descending("extracurricularUpdateID"),r.first({success:function(r){if(r)var n=r.get("extracurricularUpdateID")+1;else var n=0;for(var a=new Array,i=0;i<e.length;i++){var l=new ExtracurricularUpdateStructure;l.set({extracurricularUpdateID:n+i,extracurricularID:e[i],messageString:t}),a.push(l),Parse.Object.saveAll(a,{success:function(e){alert("Update successfully posted."),window.location.replace("./index")},error:function(e){alert(e.message),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),CommunityServiceStructure=Parse.Object.extend("CommunityServiceStructure",{create:function(e,t,r,n,a,i){if(r=new Date(t+" "+r),t=new Date(t),a=new Date(n+" "+a),n=new Date(n),!e||!t||!r||!n||!r||!i||t>n||t.getDate()===n.getDate()&&r>a)alert("Please ensure you have filled out all required fields!");else{$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("CommunityServiceStructure");l.descending("communityServiceID"),l.first({success:function(l){if(l)var s=l.get("communityServiceID")+1;else var s=0;var o=new CommunityServiceStructure,c=new Date(t.getFullYear(),t.getMonth(),t.getDate(),r.getHours(),r.getMinutes(),0,0),u=new Date(n.getFullYear(),n.getMonth(),n.getDate(),a.getHours(),a.getMinutes(),0,0);o.save({communityServiceID:s,commTitleString:e,commSummaryString:i,startDate:c,endDate:u},{success:function(e){alert("Update successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}}}),PollStructure=Parse.Object.extend("PollStructure",{create:function(e,t,r,n){if(e&&t&&r&&n){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');for(var a={},i=0;i<n.length;i++)a[n[i].toString()]="0";var l=new Parse.Query("PollStructure");l.descending("pollID"),l.first({success:function(n){if(n)var i=n.get("pollID")+1;else var i=0;var l=new PollStructure;l.save({pollID:parseInt(i).toString(),pollTitle:e,pollQuestion:t,daysActive:parseInt(r),totalResponses:"0",pollMultipleChoices:a},{success:function(e){alert("Poll successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have filled out all required fields!")}}),AlertStructure=Parse.Object.extend("AlertStructure",{create:function(e,t,r,n,a,i){if(a=new Date(n+" "+a),n=new Date(n),e&&t&&r&&("time"!==r||n&&a)){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var l=new Parse.Query("AlertStructure");l.descending("alertID"),l.first({success:function(l){var s=l.get("alertID"),o=new AlertStructure,c=new Array;c[0]="January",c[1]="February",c[2]="March",c[3]="April",c[4]="May",c[5]="June",c[6]="July",c[7]="August",c[8]="September",c[9]="October",c[10]="November",c[11]="December";var u=new Date(n.getFullYear(),n.getMonth(),n.getDate(),a.getHours(),a.getMinutes(),0,0),d=new Date;if(d>u&&"time"===r)alert("Whoops! You can't send an alert in the past!"),$("#spinnerDiv").html("");else if("now"===r){var m=c[d.getMonth()]+" "+d.getDate().toString()+", "+d.getFullYear().toString();o.save({alertID:s+1,titleString:e,authorString:t,dateString:m,isReady:1,views:0,alertTime:null,contentString:i,hasTime:0},{success:function(e){alert("Alert successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else if("time"===r){var m=c[u.getMonth()]+" "+u.getDate().toString()+", "+u.getFullYear().toString();o.save({alertID:s+1,titleString:e,authorString:t,dateString:m,isReady:0,views:0,alertTime:u,contentString:i,hasTime:1},{success:function(e){alert("Alert successfully posted."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}}),ExtracurricularStructure=Parse.Object.extend("ExtracurricularStructure",{create:function(e,t){if(e&&t){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var r=new Parse.Query("ExtracurricularStructure");r.descending("extracurricularID"),r.equalTo("titleString",e),r.count({success:function(r){if(r>0)alert("A group with this name has already been registered. Please enter a different name."),$("#spinnerDiv").html("");else{var n=new Parse.Query("ExtracurricularStructure");n.descending("extracurricularID"),n.first({success:function(r){var n=r.get("extracurricularID"),a=new ExtracurricularStructure;a.save({extracurricularID:n+1,titleString:e,descriptionString:t,hasImage:0,meetingIDs:window.daysArray.join("")},{success:function(e){var t=Parse.User.current().get("ownedEC");t.push(e.get("extracurricularID")),Parse.User.current().save({ownedEC:t},{success:function(e){alert("Group successfully registered."),window.location.replace("./index")},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})},error:function(e){alert(e),$("#spinnerDiv").html("")}})}},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}else alert("Please ensure you have correctly filled out all required fields!")}});$(function(){Parse.$=jQuery,Parse.initialize("cLBOvwh6ZTQYex37DSwxL1Cvg34MMiRWYAB4vqs0","tTcV5Ns1GFdDda44FCcG5XHBDMbLA1sxRUzSnDgW"),$("#logOut").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to log out and end your session?");1==e&&(Parse.User.logOut(),window.location.replace("./login"))}),$("#changePassword").click(function(){var e=confirm("Are you sure you want to change your password?");event.preventDefault(),1==e&&Parse.User.requestPasswordReset(Parse.User.current().get("email"),{success:function(){alert("Check your e-mail for password reset instructions!")},error:function(e){alert("Error: "+e.code+" "+e.message)}})}),$(".form-signin").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value,r=e[1].value;$("#logIn").html("Signing in..."),$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>'),Parse.User.logIn(t,r,{success:function(e){$("#spinnerDiv").html("");var t=Parse.User.current().get("verified");0===t?(localStorage.setItem("key",Parse.User.current().get("key")),localStorage.setItem("username",Parse.User.current().get("username")),window.location.replace("./verify")):window.location.replace("./index")},error:function(e,t){101===t.code&&(alert("Invalid username or password. Please try again."),$("#spinnerDiv").html(""))}})}),$(".form-horizontal").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=new UserRegisterStructure;t.create(e[0].value,e[1].value,e[2].value,e[3].value,e[4].value,e[5].value,e[6].value)}),$(".cancel").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to go back? Any unsaved progress will be lost.");1==e&&history.back()}),$(".cancel-errors").click(function(){event.preventDefault(),history.back()}),$(".cancel-verify").click(function(){event.preventDefault(),window.location.replace("./login")}),$(".cancel-schedule").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to go back? Any unsaved progress will be lost.");1==e&&window.location.replace("./schedule")}),$(".form-add-news").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Wildcat News Story for approval?");if(1==e){var t=$(this).serializeArray(),r=new NewsArticleStructure;r.create(t[0].value,t[1].value,document.getElementById("date").value,t[2].value,t[3].value)}}),$(".form-add-groupUpdate").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Group Update?");if(1==e){var t=$(this).serializeArray(),r=new ExtracurricularUpdateStructure;r.create(window.groupsArray,t[t.length-1].value)}}),$(".form-add-community").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this Community Service Update?");if(1==e){var t=$(this).serializeArray(),r=new CommunityServiceStructure;r.create(t[0].value,t[1].value,t[2].value,t[3].value,t[4].value,t[5].value)}}),$(".form-add-poll").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this User Poll?");if(1==e){var t=$(this).serializeArray(),r=new PollStructure;r.create(t[0].value,t[1].value,t[2].value,choicesArray)}}),$(".form-add-alert").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to submit this alert? It will be live to all app users.");if(1==e){var t=$(this).serializeArray(),r=new AlertStructure;r.create(t[0].value,Parse.User.current().get("firstName")+" "+Parse.User.current().get("lastName"),t[1].value,t[2].value,t[3].value,t[4].value)}}),$(".form-add-groupRegister").submit(function(){event.preventDefault();var e=window.confirm("Are you sure you want to register this new group?");if(1==e){var t=$(this).serializeArray(),r=new ExtracurricularStructure;r.create(t[0].value,t[1].value)}}),$(".form-add-custom").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value,r=e[1].value;if(r){var n=window.confirm("Are you sure you want to save this custom schedule?");if(1==n){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var a=new Parse.Query("SchoolDayStructure");a.equalTo("schoolDayID",parseInt(localStorage.getItem("customID"))),a.first({success:function(e){e.set("customString",t),e.set("customSchedule",r),e.set("scheduleType","*"),e.save(null,{success:function(){alert("Schedule successfully updated."),$("#spinnerDiv").html(""),window.location.replace("./schedule")},error:function(e){alert(e.code+" - "+e.message)}})},error:function(e){alert(e.code+" - "+e.message)}})}}else alert("No data entered!")}),$(".form-verify").submit(function(){event.preventDefault();var e=$(this).serializeArray(),t=e[0].value;if(t===localStorage.getItem("key").toString()){var r=new Parse.Query(Parse.User);r.equalTo("username",localStorage.getItem("username").toString()),r.first({success:function(e){Parse.User.current().save({verified:1},{success:function(){Parse.User.logOut(),alert("Registration complete! Welcome to WildcatConnect! Please re-enter your login credentials."),window.location.replace("./login")},error:function(e){alert(e.code+" - "+e.message),window.location.replace("./login")}})},error:function(e){alert(e.code+" - "+e.message),window.location.replace("./login")}})}else alert("Incorrect registration key."),Parse.User.logOut(),window.location.replace("./login")}),$(".saveLunch").click(function(){event.preventDefault();var e=window.confirm("Are you sure you want to save this breakfast and lunch information?");if(1==e){$("#spinnerDiv").html('<a><img src="./../spinner.gif" alt="Logo" width="40" style="vertical-align: middle; padding-top:12px; padding-left:10px;"/></a>');var t=new Array,r=new Parse.Query("SchoolDayStructure");r.equalTo("isActive",1),r.ascending("schoolDayID"),r.find({success:function(e){for(var r=0;r<e.length;r++){var n="#b_"+r.toString(),a=$(n).val(),i="#l_"+r.toString(),l=$(i).val();e[r].set("breakfastString",a),e[r].set("lunchString",l),t.push(e[r])}Parse.Object.saveAll(t,{success:function(e){alert("Breakfasts and lunches successfully updated."),$("#spinnerDiv").html(""),window.location.replace("./lunch")},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})},error:function(e){alert(e.code+" - "+e.message),$("#spinnerDiv").html("")}})}})});